# Repli-LuZhang2009

Replication of Liu et al. (2009, JPE) Investment‐Based Expected Stock Returns


---

### 1. 为什么实务中大家都在用 Factor Models？

在对冲基金（Hedge Funds）或资管机构，Factor Models（如 Barra, Fama-French, WorldQuant 101 Alphas）占据统治地位，原因有三：

#### A. 广度法则 (Fundamental Law of Active Management)
$$ IR = IC \cdot \sqrt{Breadth} $$
*   **Factor Models:** 可以无差别地应用在全市场 4000+ 只股票上，甚至应用到全球市场。只要有价格和财报，就能算因子。
*   **Structural Models (如 LWZ):** 正如你刚刚经历的，为了满足数学假设，你剔除了一半的股票（非12月结账、无债、微盘）。在实务中，**放弃一半的交易机会是不可接受的**。

#### B. 容错率与数据噪音
*   **Factor Models:** 是线性的、统计的。如果数据有一点噪音（比如季度数据不准），回归模型通常能“平滑”过去。
*   **Structural Models:** 是非线性的、刚性的。如果 $K_t$ 测不准，分母一抖动，Euler Equation 的误差就会爆炸。实盘中数据永远是脏的，结构化模型由于过于精密，往往**“水土不服”**。

#### C. 计算效率与解释性    
*   **Factor Models:** `Ret = a + b*Factor`。简单明了，向客户解释（Pitch）非常容易：“我们买低估值的股票”。
*   **Structural Models:** 需要解 GMM，参数不稳定。你很难跟客户解释：“我们买入那些边际调整成本低于边际q值的股票”。

---

### 2. 那我们为什么还要学 Structural Models？它有什么用？

既然因子模型这么好用，为什么学术界（以及顶尖的 Quant 基金如 AQR, D.E. Shaw）还要死磕结构化模型？

**因为 Factor Models 有一个致命弱点：知其然，不知其所以然。**
这导致了严重的**数据挖掘（Data Mining）**风险。

#### A. 寻找“真”因子 (Signal Discovery)
*   **现状：** 现在的量化圈太卷了。每个人都在挖掘 Price Volume 因子。
*   **LWZ 的价值：** LWZ (2009) 在当时提出了一个颠覆性的观点：**投资（Investment）和 盈利（ROE）才是核心，B/M 只是它们的投影。**
*   **实战转化：** 后来 Lu Zhang 基于这个结构化模型，提出了 **q-factor model (HXZ)**。
    *   这就是结构化模型的威力：**它为你指明了挖掘新因子的方向。**
    *   如果你不懂 LWZ，你可能还在死磕 B/M 因子，而懂的人已经开始用 Investment 和 ROE 因子收割 Alpha 了。

#### B. 改进因子构造 (Signal Refinement)
*   **普通 Quant:** 直接用 `Capex / Assets` 做因子。
*   **懂 LWZ 的 Quant:** 知道 $r^{Iw}$ 的公式里包含了**杠杆 ($w$)** 和 **税率 ($\tau$)** 的非线性调整。
    *   你会尝试构造一个“杠杆调整后的投资因子”：$\frac{I}{K} \times Leverage$。
    *   **结果：** 你的因子纯度更高，与收益率的相关性更强，因为你利用了经济学逻辑去除了噪音。

#### C. 风险控制与回撤坚守 (Conviction)
*   **场景：** 假设你的“价值因子”连续亏损了 3 年（如 2018-2020）。
*   **纯统计派：** “回测显示这不科学，因子失效了，砍仓！”
*   **结构化派：** “根据 q-theory，价值股表现差是因为现在的**调整成本 ($a$)** 发生了结构性变化（比如科技股的无形资产调整成本不同），或者是**折现率**发生了变化。”
    *   你能够从宏观机制上判断这是**周期性回撤**还是**彻底失效**。这种**信念（Conviction）**是区分顶级基金经理和普通交易员的关键。

---

### 3. 教授的实务建议：Quant 2.0 路线图

在你的职业生涯中，不要把两者对立起来，而要结合使用：

1.  **Idea Generation (灵感阶段):** **使用 Structural Models。**
    *   去读像 LWZ 这样的论文，理解资产定价的底层逻辑（生产、消费、中介摩擦）。
    *   问自己：“如果这个理论是对的，那么财务报表里的哪个科目应该预测收益？”

2.  **Implementation (落地阶段):** **使用 Stylized Factor Models。**
    *   不要直接跑 GMM 交易。
    *   把结构化模型中的核心变量（如 $I/K$, $ROE$, $Leverage$）提取出来。
    *   用线性的方法（排序、回归）去全市场测试这些变量。
    *   放松严格的假设（比如允许用季度数据，允许非 12 月结账），看信号是否依然有效。

### 总结

*   **复现 LWZ (2009) 的意义：** 不是为了让你以后在公司里写代码跑 GMM。
*   **真正的意义：** 是训练你的**“经济学直觉”**。
    *   当你看到一家公司疯狂投资扩产时，普通人想的是“它在成长”，你脑子里跳出的是 **$r^I$ 公式的分母变大 $\to$ 预期收益率变低**。
    *   这种直觉会让你避开很多动量陷阱，或者发现别人看不到的做空机会。